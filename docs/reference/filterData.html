<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Load and filter data — filterData • huntfishapp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Load and filter data — filterData" />
<meta property="og:description" content="This function has the option to either load data from a local file,
dataSource = &quot;csv&quot;, or a database backend, dataSource = &quot;sql&quot;.
If using a local file, a data frame is returned. If using a database backend,
an unevaluated dplyr data frame corresponding to a SQL query is returned." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">huntfishapp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/custom-analyses-in-r.html">Custom Analyses in R</a>
    </li>
    <li>
      <a href="../articles/installation-and-setup.html">Installation and Setup</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Load and filter data</h1>
    
    <div class="hidden name"><code>filterData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function has the option to either load data from a local file,
<code>dataSource = "csv"</code>, or a database backend, <code>dataSource = "sql"</code>.
If using a local file, a data frame is returned. If using a database backend,
an unevaluated <code>dplyr</code> data frame corresponding to a SQL query is returned.</p>
    </div>

    <pre class="usage"><span class='fu'>filterData</span>(<span class='kw'>dataSource</span> <span class='kw'>=</span> <span class='st'>"sql"</span>, <span class='kw'>conn</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>activeFilters</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dataSource</th>
      <td><p>A string specifying whether to use database backend, <code>"sql"</code>,
or a csv file, <code>"csv"</code>.</p></td>
    </tr>
    <tr>
      <th>conn</th>
      <td><p>An object created with <code>dbConnect()</code> specifying
a connection to a database management system. Only needed when
<code>dataSource = "sql"</code>.</p></td>
    </tr>
    <tr>
      <th>activeFilters</th>
      <td><p>A list of elements with names corresponding to
variables and values indicating filter condition (see details)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>dataSource="sql"</code>, returns an unevaluated dplyr data frame
corresponding to a SQL query (class: tbl_dbi,' tbl_sql, tbl_lazy, tbl). If
<code>dataSource="csv"</code>, returns a standard dplyr data frame.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>When <code>dataSource = "csv"</code>, the function will return data from the built
in dataset <code><a href='https://rdrr.io/r/utils/data.html'>data("huntfishappDemo", package = "huntfishapp")</a></code>. The
option to use a local file is provided mainly to demonstrate the app functionality
if a database backend is unavailabe. To use a different data file the source
code of the function will need to be modified. Using a local data file has
the advantage that analysis can occur very quickly because all the data is
loaded into memory. The drawbacks to using a local data file are that the
amount of data that  can be analyzed is limited by the memory available, it
may not scale well if the app is deployed to multiple users, and it may be
tedious to manage and update local data files.</p>
<p>The suggested use case is <code>dataSource = "sql"</code> to use a database backend.
When using a database backend the function will attempt to connect to a view
on the server named <code>"huntfishapp"</code> using the user supplied connection object,
<code>tbl(conn, "huntfishapp")</code>. The view should contain the following variables:</p><ul>
<li><p>itemUID: Unique integer identifier for each item (i.e., row).</p></li>
<li><p>customerUID: Unique integer identifier for customer who purchased item.</p></li>
<li><p>issueDate: Date item was purchased or issued in the format yyyy-mm-dd.</p></li>
<li><p>itemResidency: Residency attribute of item coded as "T" or "F". May
  or may not correspond to customer residency attribute.</p></li>
<li><p>duration: Duration attribute of item in character format. Any values
  are allowed.</p></li>
<li><p>residency: Residency attribute of customer coded as "T" or "F". May
  or may not correspond to item residency attribute. May or may not change
  over time.</p></li>
<li><p>state: Customer address state component coded as two letter abbreviation.</p></li>
<li><p>county: Customer address county component in title-case.</p></li>
<li><p>age: Customer age attribute.</p></li>
<li><p>itemType: Description of item type (e.g., Deer, Fish, etc.)</p></li>
<li><p>itemYear: Year attribute of item. May or may not correspond to year of
  purchase or issue date.</p></li>
<li><p>price: Price of item including relevant fees.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Demo data: All items for male customers age 0-17 in Lancaster county</span>
<span class='fu'>filterData</span>(
  <span class='kw'>dataSource</span> <span class='kw'>=</span> <span class='st'>"csv"</span>,
  <span class='kw'>activeFilters</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
    <span class='kw'>gender</span> <span class='kw'>=</span> <span class='st'>"Male"</span>,
    <span class='kw'>county</span> <span class='kw'>=</span> <span class='st'>"lancaster"</span>,
    <span class='kw'>ageGroup</span> <span class='kw'>=</span> <span class='st'>"0-17"</span>
  )
)</div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 208 x 18</span><span>
#&gt;    itemUID issueDate  itemResidency duration durationValue residency state
#&gt;      </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;date&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>         </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>            </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span>   </span><span style='text-decoration: underline;'>42</span><span>350 2017-11-11 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 2</span><span>   </span><span style='text-decoration: underline;'>39</span><span>266 2017-04-17 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 3</span><span>   </span><span style='text-decoration: underline;'>43</span><span>961 2018-04-09 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 4</span><span>    </span><span style='text-decoration: underline;'>3</span><span>854 2010-09-27 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 5</span><span>    </span><span style='text-decoration: underline;'>3</span><span>855 2010-09-27 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 6</span><span>    </span><span style='text-decoration: underline;'>7</span><span>340 2011-05-09 T             Annual               1 T         NE   
#&gt; </span><span style='color: #555555;'> 7</span><span>    </span><span style='text-decoration: underline;'>8</span><span>729 2011-08-15 T             Annual               1 T         NE   
#&gt; </span><span style='color: #555555;'> 8</span><span>    </span><span style='text-decoration: underline;'>8</span><span>730 2011-08-15 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'> 9</span><span>    </span><span style='text-decoration: underline;'>9</span><span>294 2011-09-28 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'>10</span><span>   </span><span style='text-decoration: underline;'>11</span><span>102 2011-12-30 T             Season               1 T         NE   
#&gt; </span><span style='color: #555555;'># ... with 198 more rows, and 11 more variables: itemType </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>,
#&gt; #   itemYear </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span style='color: #555555;'>, price </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, birthYear </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, gender </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, county </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>,
#&gt; #   customerUID </span><span style='color: #555555;font-style: italic;'>&lt;int&gt;</span><span style='color: #555555;'>, age </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, ageGroup </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span style='color: #555555;'>, month </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, year </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span></div><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Database connection. Suggest using keyring package to avoid hardcoding</span>
<span class='co'># passwords</span>
<span class='no'>myConn</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>DBI</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DBI/man/dbConnect.html'>dbConnect</a></span>(<span class='kw pkg'>odbc</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/odbc/man/odbc.html'>odbc</a></span>(),
  <span class='kw'>dsn</span> <span class='kw'>=</span> <span class='st'>"HuntFishApp"</span>, <span class='co'># Your datasource name</span>
  <span class='kw'>uid</span> <span class='kw'>=</span> <span class='kw pkg'>keyring</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/keyring/man/key_get.html'>key_get</a></span>(<span class='st'>"HuntFishAppUID"</span>), <span class='co'># Your username</span>
  <span class='kw'>pwd</span> <span class='kw'>=</span> <span class='kw pkg'>keyring</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/keyring/man/key_get.html'>key_get</a></span>(<span class='st'>"HuntFishAppPWD"</span>)
) <span class='co'># Your password</span>

<span class='co'># SQL Backend: Collect 10 resident waterfowl and hunt items for January 2017</span>
<span class='no'>wfJan2017</span> <span class='kw'>&lt;-</span>
  <span class='fu'>filterData</span>(
    <span class='kw'>dataSource</span> <span class='kw'>=</span> <span class='st'>"sql"</span>,
    <span class='kw'>conn</span> <span class='kw'>=</span> <span class='no'>myConn</span>,
    <span class='kw'>activeFilters</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='kw'>issueDate</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"2017-01-01"</span>, <span class='st'>"2017-01-31"</span>),
      <span class='kw'>itemType</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Waterfowl"</span>, <span class='st'>"Hunt"</span>),
      <span class='kw'>residency</span> <span class='kw'>=</span> <span class='st'>"T"</span>
    )
  )

<span class='co'># Inspect SQL query (useful for debugging)</span>
<span class='no'>wfJan2017</span> <span class='kw'>%&gt;%</span> <span class='fu'>show_query</span>()

<span class='co'># Evaluate SQL query (set n = Inf to return all rows)</span>
<span class='no'>wfJan2017</span> <span class='kw'>%&gt;%</span> <span class='fu'>collect</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>10</span>)
}</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nathaniel Price, Christopher Chizinski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


